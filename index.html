<html>
<head>
<script type="text/javascript">
	
	function search_data(){
		var inputElements = document.getElementsByClassName("chk_user_list");
		var usernames = [];
		for(var j = 0; inputElements[j]; ++j){
			if(inputElements[j].checked)
				usernames.push(inputElements[j].value);
		}
		console.log("selected users: " + usernames);
		var tagElements = document.querySelectorAll('input[class="chk_tag_list"]:checked');
		<!-- var tagElements = document.getElementsByClassName("chk_tag_list"); -->
		var tags = [];
		for(var j = 0; tagElements[j]; ++j){
			<!-- if(tagElements[j].checked) -->
				tags.push(tagElements[j].value);
		}		
		console.log("selected tags: " + tags);
		
		var selected = []
		for(var i = 0; i < tweets.length;  i++)
		{
			if(usernames.indexOf(tweets[i].user) != -1)
			{
				for(var j = 0; j < tweets[i].hashtags.length; j++)
					if(tags.indexOf(tweets[i].hashtags[j]) != -1 && selected.indexOf(tweets[i]) == -1)
						selected.push(tweets[i]);
			}
		}
		var allMsgs = '';
		console.log(allMsgs);
		document.getElementById("list").innerHTML = '';
		for(var i = 0; i < selected.length; i++)
			allMsgs += "@" + selected[i].user + ": " + selected[i].message + "<br\>";
		document.getElementById("list").innerHTML = allMsgs;
		console.log(allMsgs);
	};
	
	function newtweet(message, user, hashtags){
		tweets.push({
			message: message, 
			user: user,
			hashtags: hashtags}
			);
	};
	
	function create_list(vars, elementId){
		for(var i = 0; i < vars.length; i++){
		
			var label = document.createElement("label");
			var desc = document.createTextNode(vars[i]);
			var checkbox = document.createElement("input");
		
			checkbox.type = "checkbox";
			checkbox.className = "chk_" + elementId;
			checkbox.name = "chk_" +  vars[i];
			checkbox.value = vars[i];
		
			label.appendChild(checkbox);
			label.appendChild(desc);

			document.getElementById(elementId).appendChild(label);
			document.getElementById(elementId).appendChild(document.createElement("br"));
		}
	};
	var users = ["joe", "john", "sam"];
	var tags = ["first", "second", "third", "fourth"];
	
	var tweets = [];
	newtweet("first tweet", users[0], [tags[0], tags[2], tags[3]]);
	newtweet("second tweet", users[1], [tags[3]]);		
	newtweet("third tweet", users[2], [tags[0]]);
	newtweet("fourth tweet", users[1], [tags[1], tags[2]]);
	newtweet("fifth tweet", users[0], []);
	
</script>

</head>
<body onload="create_list(users, 'user_list'); create_list(tags, 'tag_list');">
	<div id="list">
	</div>
	<!-- <form id="search_form" name="search" method="get" onsubmit="return search_data()"> -->
	<!--	<input type="text" id="search_box" size="30" value="" name="search_box" style="display: inline;">
		<input type="text" id="tag_box" size="30" value="" name="tag_box" style="display: inline;"> -->
	<div style="width:100%;">
		<div id="user_list" style="float:left;width:50%;"> Filter users: <br/> </div>
		<div id="tag_list" style="float:left;width:50%;"> Filter tags: <br/> </div>
	</div>
	<button  type ="button" onclick="search_data()" value="Search" >Search </button> 
	<!-- </form> -->
</body>
</html>

